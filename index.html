<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#ffffff">

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ูุธุงู ุฅุฏุงุฑุฉ ููุงู ุงูุชุญููุธ</title>

  <!-- ุฎุท ุนุฑุจู -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap"
    rel="stylesheet"
  />

  <!-- ููู ุงูุชูุณูู ุงูุฎุงุฑุฌู -->
  <link rel="stylesheet" href="style.css" />

  <!-- ุชุญุณููุงุช ุณุฑูุนุฉ ุฏูู ููุณ style.css -->
  <style>
    /* ููุตูุงุช ุดุฑูุท ุงูุฎุทุฉ */
    .plan-strip {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      margin: 0.25rem 0 0;
    }
    .plan-strip .dot {
      opacity: 0.4;
      margin: 0 0.25rem;
    }
    .badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 0.25rem 0.6rem;
      border-radius: 999px;
      font-size: 0.9rem;
      line-height: 1;
      background: #f4f6f8;
      border: 1px solid #e5e7eb;
    }
    .badge-plan {
      background: #eef7ff;
      border-color: #d5e9ff;
    }
    .badge-points {
      background: #f6ffed;
      border-color: #e2f7d3;
    }
    .badge-rank {
      background: #fff3e6;
      border-color: #ffe0bf;
    }

    /* ุตู ุงููุณุจุฉ + ุงูุดุฑูุท (ูู ุงุณุชูุฎุฏูุช ูุณุชูุจูุงู) */
    .progress-card .progress-inline {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-top: 0.25rem;
    }
    .progress-card .progress-bar {
      flex: 1;
      height: 10px;
      border-radius: 8px;
      background: #eef2f7;
      overflow: hidden;
    }
    .progress-card .progress-fill {
      height: 100%;
    }
    .progress-card .progress-percent {
      margin: 0;
      font-weight: 700;
      white-space: nowrap;
    }

    /* ุชูุญูู ูุฑูุช ุงูุชูุฏู */
    .progress-card {
      padding: 12px 14px;
    }
    .progress-card h3 {
      margin: 0 0 0.25rem 0;
      font-size: 1.05rem;
    }

    /* ุชูุญูู ุจุทุงูุงุช ุงูููุงู */
    .task-card {
      padding: 12px 14px;
    }
    .task-card .task-body.mission-text {
      margin: 0.25rem 0 0.5rem;
    }

    /* ุฅุฎูุงุก ุชุจููุจุงุช ุงูุทุงูุจ ุญุงููุงู */
    .student-tabs {
      display: none;
    }

    /* ๐ต ูุฑูุช ุงูุฏูุงุฆุฑ (ุงูุญูุธ / ุงููุฑุงุฌุนุฉ) */
    .progress-section {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin: 14px 0 18px;
    }
    .circle-card {
      flex: 1 1 220px;
      display: flex;
      align-items: center;
      gap: 10px;
      background: #ffffff;
      padding: 10px 12px;
      border-radius: 16px;
      box-shadow: 0 1px 3px rgba(15, 23, 42, 0.08);
    }
    .circle-wrapper {
      position: relative;
      width: 64px;
      height: 64px;
      flex-shrink: 0;
    }
    .circle-progress {
      --value: 0;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: conic-gradient(#22c55e calc(var(--value) * 1%), #e5e7eb 0);
    }
    #mur-circle {
      background: conic-gradient(#f97316 calc(var(--value) * 1%), #e5e7eb 0);
    }
    .circle-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: #ffffff;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
      font-weight: 700;
      color: #111827;
    }
    .circle-info {
      display: flex;
      flex-direction: column;
      gap: 4px;
      font-size: 0.8rem;
    }
    .circle-title {
      font-size: 0.95rem;
      font-weight: 700;
      color: #111827;
    }
    .circle-sub {
      display: flex;
      align-items: center;
      gap: 6px;
      color: #6b7280;
    }
    .mini-bar {
      width: 100%;
      height: 6px;
      border-radius: 999px;
      background: #e5e7eb;
      overflow: hidden;
      margin-top: 2px;
    }
    .mini-bar-fill {
      height: 100%;
      width: 0;
      background: #3b82f6;
      transition: width 0.25s ease-out;
    }
    #mur-circle-card .mini-bar-fill {
      background: #f97316;
    }

    /* ุณุทุฑ "ุงูููุงู ุงูุญุงููุฉ" */
    #student-main-tasks > h3 {
      margin-top: 0;
    }
  </style>
</head>
<body>
   <!-- ุดุงุดุฉ ุงูุฏุฎูู -->
  <div id="auth-screen" class="container">
    <h1 class="app-title">ุงููููุฌ ุงูุฅููุชุฑููู</h1>
    <h2 class="app-subtitle">ุญููุฉ ุนุจุฏุงูุฑุญูู ุจู ุนูู ุฑุถู ุงููู ุนูู</h2>
    <p class="app-masjid">ุฌุงูุน ุงุฎูุงู</p>

    <h3 class="auth-title">ุชุณุฌูู ุงูุฏุฎูู</h3>

    <div class="input-group">
      <label for="user-code">ุฑูุฒ ุงูุฏุฎูู:</label>
      <input
        type="text"
        id="user-code"
        placeholder="ุฑูุฒ ุงููุนูู / ุงูุทุงูุจ / ููู ุงูุฃูุฑ"
      />
      <p class="info-text" style="display: none">
        ูุซุงู: <strong>teacher1</strong> ูููุนูู โ ุฑูุฒ ุงูุทุงูุจ โ ุฃู ุฑูุฒ ููู ุงูุฃูุฑ.
      </p>
    </div>

    <button id="login-button" class="button primary">ุฏุฎูู</button>
    <p id="auth-message" class="message hidden"></p>
  </div>


  <!-- ุดุงุดุฉ ุงูุทุงูุจ -->
  <div id="student-screen" class="container hidden">
    <header class="dashboard-header">
      <div>
        <h2 id="welcome-student">ุฃููุงู ุจู ูุง ุทุงูุจ</h2>
        <p id="student-plan-strip" class="plan-strip">
          <span id="strip-plan" class="badge badge-plan">ุงูุฎุทุฉ: โ</span>
          <span class="dot">โข</span>
          <span id="strip-points" class="badge badge-points">ุงูููุงุท: 0</span>
          <span class="dot">โข</span>
          <span id="strip-rank" class="badge badge-rank">ุงูุชุฑุชูุจ: โ</span>
        </p>
      </div>
      <div class="icon-actions">
        <button id="refresh-student-button" class="icon-button">โป</button>
        <button id="logout-button-student" class="icon-button">โป</button>
      </div>
    </header>

    <!-- ุชุจููุจุงุช ุงูุทุงูุจ (ูุฎููุฉ ุญุงููุงู ููู ููุฌูุฏุฉ ููููุฏ) -->
    <nav class="student-tabs">
      <button
        class="student-tab-button"
        data-tab="student-main-tasks"
      >
        ููุงูู ุงูุญุงููุฉ
      </button>
      <button
        class="student-tab-button"
        data-tab="student-assistant-tab"
      >
        ููุงู ุงููุณุงุนุฏ
      </button>
    </nav>

    <!-- ๐ต ุจุทุงูุงุช ุงูุฏูุงุฆุฑ (ุงูุญูุธ / ุงููุฑุงุฌุนุฉ) -->
    <section class="progress-section">
      <!-- ุจุทุงูุฉ ุงูุญูุธ -->
      <div class="circle-card" id="hifz-circle-card">
        <div class="circle-wrapper">
          <div class="circle-progress" id="hifz-circle"></div>
          <div class="circle-center">
            <span id="hifz-circle-percent">0%</span>
          </div>
        </div>
        <div class="circle-info">
          <div class="circle-title">ุงูุญูุธ</div>
          <div class="circle-sub">
            <span id="hifz-circle-fraction">0 / 0</span>
          </div>
          <div class="mini-bar">
            <div id="hifz-circle-mini-bar" class="mini-bar-fill"></div>
          </div>
        </div>
      </div>

      <!-- ุจุทุงูุฉ ุงููุฑุงุฌุนุฉ -->
      <div class="circle-card" id="mur-circle-card">
        <div class="circle-wrapper">
          <div class="circle-progress" id="mur-circle"></div>
          <div class="circle-center">
            <span id="mur-circle-percent">0%</span>
          </div>
        </div>
        <div class="circle-info">
          <div class="circle-title">ุงููุฑุงุฌุนุฉ</div>
          <div class="circle-sub">
            <span id="mur-circle-fraction">0 / 0</span>
          </div>
          <div class="mini-bar">
            <div id="mur-circle-mini-bar" class="mini-bar-fill"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- ุชุจููุจ: ููุงูู ุงูุญุงููุฉ -->
    <section id="student-main-tasks" class="tasks-section">
      <h3>ููุงูู ุงูุญุงููุฉ</h3>
      <div id="student-tasks" class="tasks-list">
        <p class="message info">ูุง ุชูุฌุฏ ููุงู ุญุงููุงู. ูููู ุงููู ๐ค</p>
      </div>
    </section>

    <!-- ุชุจููุจ: ููุงู ุงููุณุงุนุฏ (ูู ุชุธูุฑ ุญุงููุงู) -->
    <section id="student-assistant-tab" class="tasks-section hidden">
      <h3>ููุงู ุงููุณุงุนุฏ</h3>
      <p class="info-text">
        ุฅุฐุง ููุช ุทุงูุจูุง ูุณุงุนุฏูุงุ ุณุชุธูุฑ ููุง ุงูููุงู ุงูุชู ูุฌูููุง ูู ุงููุนูู ููุฑุงุฌุนุชูุง.
      </p>
      <div id="student-assistant-tasks" class="tasks-list">
        <!-- ูุชู ููุคูุง ูู app.js -->
      </div>
    </section>
  </div>

  <!-- ุดุงุดุฉ ุงููุนูู -->
  <div id="teacher-screen" class="container hidden">
    <header class="dashboard-header">
      <div>
        <h2>ููุญุฉ ุชุญูู ุงููุนูู</h2>
        <p class="subtitle">ุฅุฏุงุฑุฉ ููุงู ุงูุทูุงุจ ูุฎุทุทูู</p>
      </div>
      <div class="icon-actions">
        <button id="refresh-teacher-button" class="icon-button">โป</button>
        <button id="logout-button-teacher" class="icon-button">โป</button>
      </div>
    </header>

    <!-- ุชุจููุจุงุช ุงููุนูู -->
    <nav class="tabs">
      <button
        class="tab-button active"
        data-tab="review-tasks-tab"
      >
        ููุงู ุจุงูุชุธุงุฑ ุงููุฑุงุฌุนุฉ ๐
      </button>
      <button class="tab-button" data-tab="assign-tasks-tab">
        ุชุนููู ููุงู
      </button>
      <button class="tab-button" data-tab="manage-students-tab">
        ุฅุฏุงุฑุฉ ุงูุทูุงุจ
      </button>
      <button class="tab-button" data-tab="curriculum-tab">
        ุนุฑุถ ุงููููุฌ
      </button>
    </nav>

    <section class="tab-content-container">
      <!-- ูุฑุงุฌุนุฉ ุงูููุงู -->
      <div id="review-tasks-tab" class="tab-content">
        <h3>ููุงู ุจุงูุชุธุงุฑ ูุฑุงุฌุนุชู</h3>
        <p class="info-text">
          ููุง ุชุธูุฑ ุงูููุงู ุงูุชู ุฃุฑุณููุง ุงูุทูุงุจ ูููุฑุงุฌุนุฉ. ููููู ูุจูููุง ุฃู ุฑูุถูุง.
        </p>
        <div id="pending-tasks-list" class="tasks-review-container">
          <p class="message info">ุฌุงุฑู ุชุญููู ุงูููุงู...</p>
        </div>
      </div>

      <!-- ุชุนููู ุงูููุงู -->
      <div id="assign-tasks-tab" class="tab-content hidden">
        <h3>ุชุนููู ููุงู ุฌุฏูุฏุฉ</h3>

        <div class="input-group">
          <label for="assign-task-student-code">ุฑูุฒ ุงูุทุงูุจ (ูููุฑุฏู):</label>
          <input
            type="text"
            id="assign-task-student-code"
            placeholder="ุงุชุฑูู ูุงุฑุบูุง ูุชุนููู ุงููููุฉ ูุฌููุน ุงูุทูุงุจ"
          />
        </div>

        <div class="input-group">
          <label for="assign-task-type">ููุน ุงููููุฉ:</label>
          <select id="assign-task-type">
            <option value="general">ูููุฉ ุนุงูุฉ</option>
            <option value="hifz">ุญูุธ</option>
            <option value="murajaa">ูุฑุงุฌุนุฉ</option>
          </select>
        </div>

        <div class="input-group">
          <label for="assign-task-description">ูุตู ุงููููุฉ:</label>
          <input
            type="text"
            id="assign-task-description"
            placeholder="ูุซุงู: ุญูุธ ุฃูู 5 ุขูุงุช ูู ุณูุฑุฉ ุงูุจูุฑุฉ"
          />
        </div>

        <div class="input-group">
          <label for="assign-task-points">ุงูููุงุท:</label>
          <input
            type="number"
            id="assign-task-points"
            value="10"
            min="1"
          />
        </div>

        <div class="action-buttons">
          <button
            id="assign-individual-task-button"
            class="button primary"
          >
            ุชุนููู ูุฑุฏู
          </button>
          <button
            id="assign-group-task-button"
            class="button success"
          >
            ุชุนููู ุฌูุงุนู (ููู ุงูุทูุงุจ)
          </button>
        </div>

        <p id="assign-task-message" class="message hidden"></p>
      </div>

      <!-- ุฅุฏุงุฑุฉ ุงูุทูุงุจ -->
      <div id="manage-students-tab" class="tab-content hidden">
        <h3 id="student-form-title">ุฅุถุงูุฉ / ุชุนุฏูู ุทุงูุจ</h3>

        <div class="student-form">
          <div class="input-group">
            <label for="new-student-code">ุฑูุฒ ุงูุทุงูุจ:</label>
            <input
              type="text"
              id="new-student-code"
              placeholder="ูุซุงู: 101"
            />
          </div>

          <div class="input-group">
            <label for="new-student-name">ุงุณู ุงูุทุงูุจ:</label>
            <input
              type="text"
              id="new-student-name"
              placeholder="ุงูุงุณู ุงููุงูู"
            />
          </div>

          <div class="input-group">
            <label for="new-student-parent-name">ุงุณู ููู ุงูุฃูุฑ (ุงุฎุชูุงุฑู):</label>
            <input
              type="text"
              id="new-student-parent-name"
              placeholder="ุงุณู ููู ุงูุฃูุฑ"
            />
          </div>

          <div class="input-group">
            <label for="new-student-parent-code">ุฑูุฒ ููู ุงูุฃูุฑ (ุงุฎุชูุงุฑู):</label>
            <input
              type="text"
              id="new-student-parent-code"
              placeholder="ูุซุงู: P100 (ูุณุชุฎุฏูู ููู ุงูุฃูุฑ ููุฏุฎูู)"
            />
          </div>

          <div class="input-group">
            <label for="new-student-hifz-start">ููุทุฉ ุจุฏุงูุฉ ุงูุญูุธ:</label>
            <select id="new-student-hifz-start"></select>
          </div>

          <div class="input-group">
            <label for="new-student-hifz-end">ููุทุฉ ููุงูุฉ ุงูุญูุธ:</label>
            <select id="new-student-hifz-end"></select>
          </div>

          <div class="input-group">
            <label for="new-student-hifz-level">ูุณุชูู ุงูุญูุธ (ุนุฏุฏ ุงูููุงุทุน):</label>
            <select id="new-student-hifz-level">
              <option value="1">ููุทุน ูุงุญุฏ (1x)</option>
              <option value="2">ููุทุนูู (2x)</option>
              <option value="3">ุซูุงุซุฉ ููุงุทุน (3x)</option>
            </select>
          </div>

          <div class="input-group">
            <label for="new-student-murajaa-level">ูุณุชูู ุงููุฑุงุฌุนุฉ (ุงูุญููุฉ):</label>
            <select id="new-student-murajaa-level">
              <option value="BUILDING">ุงูุจูุงุก</option>
              <option value="DEVELOPMENT">ุงูุชุทููุฑ</option>
              <option value="ADVANCED">ุงููุชูุฏู</option>
            </select>
          </div>

          <div class="input-group">
            <label for="new-student-murajaa-start">ููุทุฉ ุจุฏุงูุฉ ุงููุฑุงุฌุนุฉ:</label>
            <select id="new-student-murajaa-start"></select>
            <p class="info-text">
              ูุฐู ุฃูู ูููุฉ ูุฑุงุฌุนุฉ ูุจุฏุฃ ูููุง ุงูุทุงูุจ ูู ุฏูุฑุชู ุงูุญุงููุฉ.
            </p>
          </div>

          <div class="input-group">
            <label for="new-student-halaqa">ููุน ุงูุญููุฉ:</label>
            <select id="new-student-halaqa">
              <option value="ONSITE">ุญููุฉ ุญุถูุฑูุฉ</option>
              <option value="ONLINE">ุญููุฉ ุฅููุชุฑูููุฉ</option>
            </select>
          </div>

          <button
            id="register-student-button"
            class="button primary"
          >
            ุญูุธ ุจูุงูุงุช ุงูุทุงูุจ
          </button>
          <p id="register-student-message" class="message hidden"></p>
        </div>

        <hr />

        <h3>ูุงุฆูุฉ ุงูุทูุงุจ</h3>
        <ul id="student-list" class="data-list"></ul>
      </div>

      <!-- ุนุฑุถ ุงููููุฌ -->
      <div id="curriculum-tab" class="tab-content hidden">
        <h3>ุนุฑุถ ุงููููุฌ</h3>
        <div class="curriculum-view">
          <div>
            <h4>ูููุฌ ุงูุญูุธ</h4>
            <div id="hifz-curriculum-display" class="curriculum-list"></div>
          </div>
          <div>
            <h4>ูููุฌ ุงููุฑุงุฌุนุฉ</h4>
            <div id="murajaa-curriculum-display" class="curriculum-list"></div>
          </div>
        </div>

        <hr />

        <h3>ููุญุฉ ุงูุดุฑู ุญุณุจ ุงููุณุชูู</h3>
        <div id="honor-board" class="tasks-review-container">
          <p class="message info">ุฌุงุฑู ุชุญููู ููุญุฉ ุงูุดุฑู...</p>
        </div>
      </div>
    </section>
  </div>

  <!-- ุดุงุดุฉ ููู ุงูุฃูุฑ -->
  <div id="parent-screen" class="container hidden">
    <header class="dashboard-header">
      <div>
        <h2 id="welcome-parent">ูุฑุญุจูุง ุจู ูุง ููู ุงูุฃูุฑ</h2>
        <p class="subtitle">
          ูุชุงุจุนุฉ ุฅูุฌุงุฒ ุงูุฃุจูุงุก ูู ุงูุญูุธ ูุงููุฑุงุฌุนุฉ
        </p>
      </div>
      <div class="icon-actions">
        <button id="logout-button-parent" class="icon-button">โป</button>
      </div>
    </header>

    <div class="parent-layout">
      <!-- ุนููุฏ ุงูุฃุจูุงุก -->
      <section class="parent-column main">
        <h3 class="section-title">ุฃุจูุงุคู ุงููุณุฌููู</h3>
        <div id="parent-children-list" class="children-list">
          <p class="message info">ุฌุงุฑู ุชุญููู ุจูุงูุงุช ุงูุฃุจูุงุก...</p>
        </div>
      </section>

      <!-- ุนููุฏ ููุงู ุงููุณุงุนุฏ -->
      <section class="parent-column side">
        <h3 class="section-title">ููุงู ุงููุณุงุนุฏ ูููู ุงูุฃูุฑ</h3>
        <p class="info-text">
          ุฅุฐุง ููุช ููู ุฃูุฑ ูุณุงุนุฏูุงุ ุณุชุธูุฑ ููุง ุงูููุงู ุงูุชู ูุฌูููุง ุงููุนูู ูู ููุฑุงุฌุนุชูุง.
        </p>
        <div id="parent-assistant-tasks" class="tasks-review-container">
          <!-- ูุชู ููุคูุง ูู app.js -->
        </div>
      </section>
    </div>
  </div>


  <!-- ุดุงุดุฉ ููุฏ ุงูุญููุฉ (ุดุจูุฉ ุงูุทูุงุจ) -->
  <div id="halaqa-screen" class="container hidden">
    <header class="dashboard-header">
      <div>
        <h2 id="halaqa-title">ุญุณุงุจุงุช ุงูุญููุฉ</h2>
        <p id="halaqa-subtitle" class="subtitle"></p>
      </div>
      <div class="header-actions">
        <button id="halaqa-back-button" class="button danger">
          ุฑุฌูุน ูุดุงุดุฉ ุงูุฏุฎูู
        </button>
      </div>
    </header>

    <section>
      <h3>ุทูุงุจ ูุฐู ุงูุญููุฉ</h3>
      <div id="halaqa-students-grid" class="halaqa-grid">
        <!-- ูุชู ููุคูุง ูู app.js -->
      </div>
    </section>
  </div>

  <!-- ููุทู ุงูุชุทุจูู -->
  <script type="module" src="app.js"></script>
  <script>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js");
  }
</script>

</body>
</html>
